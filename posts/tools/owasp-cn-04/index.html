<!doctype html><html><head><title>OWASP 十大网站安全风险 （四）：XML外部处理器漏洞</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="OWASP 十大网站安全风险 （四）：XML外部处理器漏洞"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-123-45','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png alt=Logo>Shubo Zhang</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/site/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=https://shubozhang.github.io/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/aws/>AWS</a><ul><li><a href=/posts/aws/dynamodb-acid/>dynamodb-acid</a></li><li><a href=/posts/aws/dynamodb-admin/>dynamodb-admin</a></li><li><a href=/posts/aws/3-ways-to-log-s3/>S3-log</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/db/>DB</a><ul><li><a href=/posts/db/mysql-count/>How to Use MySQL count</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/micronaut/>micronaut</a><ul><li><a href=/posts/micronaut/mn-graalvm/>mn-graalvm</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/software-design-and-engineering/>Software Design and Engineering</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/software-design-and-engineering/clean-code/>Clean Code</a><ul><li><a href=/posts/software-design-and-engineering/clean-code/01-meaningful-names/>01-Meaningful Names</a></li></ul></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/tools/>Tools</a><ul class=active><li><a href=/posts/tools/mac-itsycal/>mac-itsycal</a></li><li><a href=/posts/tools/mac-stats/>mac-stats</a></li><li><a href=/posts/tools/mac-world-time/>mac-world-time</a></li><li><a href=/posts/tools/owasp-cn-01/>owasp-1-sql-injection</a></li><li><a href=/posts/tools/owasp-cn-02/>owasp-2-broken-authentication</a></li><li><a href=/posts/tools/owasp-cn-03/>owasp-3-sensitive-data-exposure</a></li><li><a class=active href=/posts/tools/owasp-cn-04/>owasp-4-XML-External-Entities (XXE)</a></li><li><a href=/posts/tools/pg12/>Postgres 12 + pgadmin in Docker</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://shubozhang.github.io/posts/tools/owasp-cn-04/owasp-top-ten.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/site/shubo_zhang.jpg alt="Author Image"><h5 class=author-name>Shubo Zhang</h5><p>April 30, 2021</p></div><div class=title><h1>OWASP 十大网站安全风险 （四）：XML外部处理器漏洞</h1></div><div class=post-content id=post-content><h2 id=owasp-十大信息安全主题>OWASP 十大信息安全主题</h2><blockquote><ol><li>注入攻击 （Injection）</li><li>无效身份认证（Broken Authentication</li><li>敏感信息泄漏（Sensitive Data Exposure）</li><li><strong>XML外部处理器漏洞（XML External Entities (XXE)）</strong></li><li>无效存取控管（Broken Access Control）</li><li>错误设置安全系统（Security Misconfiguration）</li><li>跨站攻击（Cross-Site Scripting (XSS)）</li><li>不安全的反序列化漏洞（Insecure Deserialization）</li><li>使用已有漏洞元件（Using Components with Known Vulnerabilities）</li><li>日志和监控不足风险（Insufficient Logging and Monitoring）</li></ol></blockquote><h2 id=xml外部处理器漏洞>XML外部处理器漏洞</h2><p>Many older or poorly configured XML processors evaluate external entity reference within XML documents.
External entities can be used to disclose internal files using the file URI handler, internal file shares
, internal port scanning, remote code execution, and denial of service attacks.</p><h3 id=了解xml外部处理器漏洞>了解XML外部处理器漏洞</h3><p>attackers can exploit vulnerable xml processors if they can upload xml or include hostile content in an xml document
exploiting vulnerable code dependencies or integrations.</p><p>By default many older xml processors a while specifications of an external entity, URI, that is the reference</p><p>and evaluated during xml processing.</p><p>SAST tools can discover this issue by inspecting dependencies and configuration.</p><p>DAST tools require additional manual steps to detect and exploit this issue. Manual testers need to be trained in how
to test for XXE, as it is not commonly tested as of 2017.</p><p>These flaws, can be used to extract data ,executed remote request from the server , scan internal systems and or perform
a denial of service attack, as well as executed other attacks</p><p>The business impact depends on the protections of all affected applications and data.</p><h3 id=is-your-application-vulnerable>Is your application Vulnerable</h3><p>Applications, and in particular xml based web services for downstream integrations might be vulnerable to attack if the
application, except xml directly for xml uploads, especially from untrusted sources for inserts untrusted data into xml
documents which is then parsed by an xml processor.</p><p>Any of the xml processors in the application or soap based web services has DTD or document type definitions enabled.</p><p>As the exact mechanism for disabling DTD processing varies by processor, it is good practice to consult a reference,
such as the OWASP cheat sheet &lsquo;XXE prevention&rsquo;.</p><p>If your application uses SAML for identity processing within federated security or single sign on sso purposes.
SAML uses xml for identity assertions, and may be vulnerable.</p><p>If the application uses soap to version 1.2, it is likely susceptible to XXE attacks if xml entities so being passed
through soap framework.</p><p>Being vulnerable to XXE attacks likely means that the application is vulnerable to denial of service attacks,
including the billion laughs attack.</p><h3 id=examples>Examples</h3><p>Numerous public execs the issues have been discovered instantly attacking and then devices and XXE occurs in a lot of
unexpected places, including deeply nested dependencies, the easiest way is to upload malicious xml file accepted.</p><h5 id=scenario-one-the-attacker-attempts-to-extract-data-from-the-server>scenario one the attacker attempts to extract data from the server</h5><h5 id=scenario-to-an-attack-improves-the-servers-private>scenario to an attack improves the servers private</h5><p>network by changing the below entity on</p><h5 id=scenario-three-an-attacker-attempts-a-denial-of-service-attack-by-including-a-potentially-endless-file>scenario three an attacker attempts a denial of service attack by including a potentially endless file.</h5><h3 id=how-to-prevent-this>How to prevent this</h3><p>Developer training is essential to identify and mitigate XXE.</p><p>Besides that prevented XXE requires that you whenever possible use less complex data formats, such as Jason and avoid
serialization of sensitive data.</p><p>Patch or upgrade all xml processors and libraries in use by the application or on the underlying operating system.</p><p>Use dependency checkers.</p><p>Update soap to SOAP 1.2 or higher.</p><p>Disable xml external entity DTD processing in all xml horses in the application , as per the OWASP cheat sheet &lsquo;XXE prevention&rsquo;.</p><p>Implement positive server-side input validation, filtering, or sanitization to prevent hostile data within xml documents, headers, or nodes.</p><p>Verify that xml or XSL file upload functionality validates incoming xml using XSD validation or similar.</p><p>SAST tools can help detect XXE in source code, although manual code review is the best alternative in large complex
applications with many integrations.</p><p>If these controls are not possible considering using virtual patching, API security gateways, or web application firewalls (WAFs)
to detect, monitor, and block XXE attacks.</p></div><div class=btn-improve-page><a href=https://github.com/shubozhang/shubozhang.github.io/edit/source/content/posts/tools/owasp-cn-04/index.md target=_blank><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/search/ class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>Search Results</div></a></div><div class="col-md-6 next-article"><a href=/posts/tools/owasp-cn-03/ class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>OWASP 十大网站安全风险 （三）：敏感信息泄漏</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement("script"),a.type="text/javascript",a.async=!0,b="shubozhang",a.src="//"+b+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#owasp-十大信息安全主题>OWASP 十大信息安全主题</a></li><li><a href=#xml外部处理器漏洞>XML外部处理器漏洞</a><ul><li><a href=#了解xml外部处理器漏洞>了解XML外部处理器漏洞</a></li><li><a href=#is-your-application-vulnerable>Is your application Vulnerable</a></li><li><a href=#examples>Examples</a><ul><li><ul><li><a href=#scenario-one-the-attacker-attempts-to-extract-data-from-the-server>scenario one the attacker attempts to extract data from the server</a></li><li><a href=#scenario-to-an-attack-improves-the-servers-private>scenario to an attack improves the servers private</a></li><li><a href=#scenario-three-an-attacker-attempts-a-denial-of-service-attack-by-including-a-potentially-endless-file>scenario three an attacker attempts a denial of service attack by including a potentially endless file.</a></li></ul></li></ul></li><li><a href=#how-to-prevent-this>How to prevent this</a></li></ul></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About Me</a></li><li class=nav-item><a class=smooth-scroll href=/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=/#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>shubozhang@outlook.com</span></li><li><span>Phone:</span> <span>+0123456789</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form><div class=form-group><input type=email class=form-control id=exampleInputEmail1 aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">We'll never share your email with anyone else.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad()</script></body></html>
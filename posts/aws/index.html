<!doctype html><html><head><title>AWS</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/layouts/list.css><link rel=stylesheet href=/css/navigators/sidebar.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-123-45','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png alt=Logo>Shubo Zhang</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/site/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=https://shubozhang.github.io/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/aws/>AWS</a><ul class=active><li><a href=/posts/aws/dynamodb-acid/>dynamodb-acid</a></li><li><a href=/posts/aws/dynamodb-admin/>dynamodb-admin</a></li><li><a href=/posts/aws/3-ways-to-log-s3/>S3-log</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/db/>DB</a><ul><li><a href=/posts/db/mysql-count/>How to Use MySQL count</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/micronaut/>micronaut</a><ul><li><a href=/posts/micronaut/mn-graalvm/>mn-graalvm</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/software-design-and-engineering/>Software Design and Engineering</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/software-design-and-engineering/clean-code/>Clean Code</a><ul><li><a href=/posts/software-design-and-engineering/clean-code/01-meaningful-names/>01-Meaningful Names</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/tools/>Tools</a><ul><li><a href=/posts/tools/itsycal/>mac-itsycal</a></li><li><a href=/posts/tools/mac-stats/>mac-stats</a></li><li><a href=/posts/tools/mac-world-time/>mac-world-time</a></li><li><a href=/posts/tools/owasp-cn-01/>owasp-1-sql-injection</a></li><li><a href=/posts/tools/owasp-cn-02/>owasp-2-broken-authentication</a></li><li><a href=/posts/tools/owasp-cn-03/>owasp-3-sensitive-data-exposure</a></li><li><a href=/posts/tools/pg12/>Postgres 12 + pgadmin in Docker</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid post-card-holder" id=post-card-holder><div class=post-card><a href=/posts/aws/dynamodb-acid/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/aws/dynamodb-acid/hero.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>NoSql也搞ACID：DynamoDB Transaction</h5><p class="card-text post-summary">先扯扯为啥用DynamoDB，简单说就是公司没有或者没人愿意干DBA，SRE也不想干这活。。。感觉到了cloud后，DBA都华丽转身大数据了，不屑于在搞RDS。 还有些公司搞"you write it， you deploy it，and you maintain it"，一个组要负责自己的产品，从UI到DB，个个都要full-stack。DynamoDB就属于Developer完全可以搞定的， 不需要DBA或者SRE帮忙。 一般业务不需要多表join的，DynamoDB设计好了都没问题，还是有些dev说，我们的业务需要ACID，今天就来打脸了，Transaction is not a deal breaker for Dynamodb anymore。
DynamoDB Transaction保证ACID。ACID意思是atomicity, consistency, isolation, and durability。这里主要谈的是atomicity，同时操作 多个表或者行，结果要是all or nothing，全部操作成功，或者什么都不做。
两个Transactional API TransactWriteItems
一个transaction最多操作25个不用的items，每个item大小不超过400 KB，整个transaction大小不超过4 MB。 同一个transaction只能操作同一个item一次。 消耗双倍WCUs。 可以用client token来保持幂等(10 mins)。 TransactReadItems
一个transaction最多操作25个不用的GET，整个transaction大小不超过4 MB。 返回的是同步读的结果。 消耗双倍RCUs。 读写都不用锁，有冲突就会取消transaction，需要自己处理retry。注意，即使但transaction取消了，还是消耗同样的capacity units。 其他：
transaction读写都不用锁，有冲突就会取消transaction，需要自己处理retry。注意，即使但transaction取消了，还是消耗同样的capacity units。 transaction必须在同一个AWS region transaction必须在同一个AWS 账户 transaction必须在DynamoDB里 例子 源码： https://github.</p></div><div class=card-footer><span class=float-left>March 27, 2021</span>
<a href=/posts/aws/dynamodb-acid/ class="float-right btn btn-outline-info btn-sm">Read</a></div></div></a></div><div class=post-card><a href=/posts/aws/dynamodb-admin/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/aws/dynamodb-admin/hero.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>介绍一个本地DynamoDB图形界面应用: dynamodb-admin</h5><p class="card-text post-summary">DynamoDB一直被人诟病没有好的query tool，查询数据很麻烦，到现在也没有。在就是本地开发不是很友好，AWS提供了Dynamodb Local，但是aws cli query数据 还是很麻烦。今天推荐一个给DynamoDB Local做的Graphical User Interface (GUI)&mdash;dynamodb-admin，可以像在AWS console一样，让本地数据可视化和操作化。
快速设置 通过npm安装dynamodb-admin
npm install -g dynamodb-admin 运行docker： local dynamodb
docker-compose.yml file
version: '3.8'services: dynamodb-local: command: "-jar DynamoDBLocal.jar -sharedDb -optimizeDbBeforeStartup -dbPath ./data" image: "amazon/dynamodb-local:latest" container_name: dynamodb-local ports: - "8000:8000" volumes: - "./docker/dynamodb:/home/dynamodblocal/data" working_dir: /home/dynamodblocalRun docker-compose.yml file
docker-compose up -d 启动dynamodb-admin
MacOS： dynamodb-admin // 或者定义region和credentials AWS_REGION=eu-west-1 AWS_ACCESS_KEY_ID=local AWS_SECRET_ACCESS_KEY=local dynamodb-admin Windows: export DYNAMO_ENDPOINT=http://localhost:8000 dynamodb-admin 完成</p></div><div class=card-footer><span class=float-left>March 16, 2021</span>
<a href=/posts/aws/dynamodb-admin/ class="float-right btn btn-outline-info btn-sm">Read</a></div></div></a></div><div class=post-card><a href=/posts/aws/3-ways-to-log-s3/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/aws/3-ways-to-log-s3/s3-logo.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>Three ways to log S3 Bucket Activities</h5><p class="card-text post-summary">A common requirement is to monitor S3 bucket activities, especially for the purpose of auditing. In this blog, I will introduce three ways to implement this feature.
1. Use S3 properties Enable Server Access Logging for an S3 Bucket. It is one of the S3 bucket properties. You just need to select a target bucket and prefix to complete the setup. The details are available here: https://docs.aws.amazon.com/AmazonS3/latest/user-guide/server-access-logging.html
Pros: less infrastructure no code involved easy to search log for a specific bucket.</p></div><div class=card-footer><span class=float-left>December 20, 2020</span>
<a href=/posts/aws/3-ways-to-log-s3/ class="float-right btn btn-outline-info btn-sm">Read</a></div></div></a></div></div><div class=paginator></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About Me</a></li><li class=nav-item><a class=smooth-scroll href=/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=/#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>shubozhang@outlook.com</span></li><li><span>Phone:</span> <span>+0123456789</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form><div class=form-group><input type=email class=form-control id=exampleInputEmail1 aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">We'll never share your email with anyone else.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=/js/list.js></script></body></html>